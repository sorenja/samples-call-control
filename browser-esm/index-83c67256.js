/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
function t(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,u)}c((r=r.apply(t,e||[])).next())}))}function e(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function n(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function i(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function o(t){return"function"==typeof t}var s=!1,u={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack;s=t},get useDeprecatedSynchronousErrorHandling(){return s}};function c(t){setTimeout((function(){throw t}),0)}var a={closed:!0,next:function(t){},error:function(t){if(u.useDeprecatedSynchronousErrorHandling)throw t;c(t)},complete:function(){}},h=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function l(t){return null!==t&&"object"==typeof t}var p=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map((function(t,e){return e+1+") "+t.toString()})).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),f=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var n=this,r=n._parentOrParents,i=n._ctorUnsubscribe,s=n._unsubscribe,u=n._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,r instanceof t)r.remove(this);else if(null!==r)for(var c=0;c<r.length;++c){r[c].remove(this)}if(o(s)){i&&(this._unsubscribe=void 0);try{s.call(this)}catch(t){e=t instanceof p?d(t.errors):[t]}}if(h(u)){c=-1;for(var a=u.length;++c<a;){var f=u[c];if(l(f))try{f.unsubscribe()}catch(t){e=e||[],t instanceof p?e=e.concat(d(t.errors)):e.push(t)}}}if(e)throw new p(e)}},t.prototype.add=function(e){var n=e;if(!e)return t.EMPTY;switch(typeof e){case"function":n=new t(e);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof t)){var r=n;(n=new t)._subscriptions=[r]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var i=n._parentOrParents;if(null===i)n._parentOrParents=this;else if(i instanceof t){if(i===this)return n;n._parentOrParents=[i,this]}else{if(-1!==i.indexOf(this))return n;i.push(this)}var o=this._subscriptions;return null===o?this._subscriptions=[n]:o.push(n),n},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var n=e.indexOf(t);-1!==n&&e.splice(n,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function d(t){return t.reduce((function(t,e){return t.concat(e instanceof p?e.errors:e)}),[])}var E=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),_=function(t){function e(n,r,i){var o=t.call(this)||this;switch(o.syncErrorValue=null,o.syncErrorThrown=!1,o.syncErrorThrowable=!1,o.isStopped=!1,arguments.length){case 0:o.destination=a;break;case 1:if(!n){o.destination=a;break}if("object"==typeof n){n instanceof e?(o.syncErrorThrowable=n.syncErrorThrowable,o.destination=n,n.add(o)):(o.syncErrorThrowable=!0,o.destination=new v(o,n));break}default:o.syncErrorThrowable=!0,o.destination=new v(o,n,r,i)}return o}return i(e,t),e.prototype[E]=function(){return this},e.create=function(t,n,r){var i=new e(t,n,r);return i.syncErrorThrowable=!1,i},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(f),v=function(t){function e(e,n,r,i){var s,u=t.call(this)||this;u._parentSubscriber=e;var c=u;return o(n)?s=n:n&&(s=n.next,r=n.error,i=n.complete,n!==a&&(o((c=Object.create(n)).unsubscribe)&&u.add(c.unsubscribe.bind(c)),c.unsubscribe=u.unsubscribe.bind(u))),u._context=c,u._next=s,u._error=r,u._complete=i,u}return i(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,n=u.useDeprecatedSynchronousErrorHandling;if(this._error)n&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)n?(e.syncErrorValue=t,e.syncErrorThrown=!0):c(t),this.unsubscribe();else{if(this.unsubscribe(),n)throw t;c(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var n=function(){return t._complete.call(t._context)};u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),u.useDeprecatedSynchronousErrorHandling)throw t;c(t)}},e.prototype.__tryOrSetError=function(t,e,n){if(!u.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,n)}catch(e){return u.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(c(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(_);var y=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function b(t){return t}function g(t){return 0===t.length?b:1===t.length?t[0]:function(e){return t.reduce((function(t,e){return e(t)}),e)}}var A=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(t,e,n){var r=this.operator,i=function(t,e,n){if(t){if(t instanceof _)return t;if(t[E])return t[E]()}return t||e||n?new _(t,e,n):new _(a)}(t,e,n);if(r?i.add(r.call(i,this.source)):i.add(this.source||u.useDeprecatedSynchronousErrorHandling&&!i.syncErrorThrowable?this._subscribe(i):this._trySubscribe(i)),u.useDeprecatedSynchronousErrorHandling&&i.syncErrorThrowable&&(i.syncErrorThrowable=!1,i.syncErrorThrown))throw i.syncErrorValue;return i},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){u.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),!function(t){for(;t;){var e=t,n=e.closed,r=e.destination,i=e.isStopped;if(n||i)return!1;t=r&&r instanceof _?r:null}return!0}(t)?console.warn(e):t.error(e)}},t.prototype.forEach=function(t,e){var n=this;return new(e=w(e))((function(e,r){var i;i=n.subscribe((function(e){try{t(e)}catch(t){r(t),i&&i.unsubscribe()}}),r,e)}))},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[y]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:g(t)(this)},t.prototype.toPromise=function(t){var e=this;return new(t=w(t))((function(t,n){var r;e.subscribe((function(t){return r=t}),(function(t){return n(t)}),(function(){return t(r)}))}))},t.create=function(e){return new t(e)},t}();function w(t){if(t||(t=Promise),!t)throw new Error("no Promise impl found");return t}var T=function(){function t(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return t.prototype=Object.create(Error.prototype),t}(),m=function(t){function e(e,n){var r=t.call(this)||this;return r.subject=e,r.subscriber=n,r.closed=!1,r}return i(e,t),e.prototype.unsubscribe=function(){if(!this.closed){this.closed=!0;var t=this.subject,e=t.observers;if(this.subject=null,e&&0!==e.length&&!t.isStopped&&!t.closed){var n=e.indexOf(this.subscriber);-1!==n&&e.splice(n,1)}}},e}(f),S=function(t){function e(e){var n=t.call(this,e)||this;return n.destination=e,n}return i(e,t),e}(_),N=function(t){function e(){var e=t.call(this)||this;return e.observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return i(e,t),e.prototype[E]=function(){return new S(this)},e.prototype.lift=function(t){var e=new O(this,this);return e.operator=t,e},e.prototype.next=function(t){if(this.closed)throw new T;if(!this.isStopped)for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].next(t)},e.prototype.error=function(t){if(this.closed)throw new T;this.hasError=!0,this.thrownError=t,this.isStopped=!0;for(var e=this.observers,n=e.length,r=e.slice(),i=0;i<n;i++)r[i].error(t);this.observers.length=0},e.prototype.complete=function(){if(this.closed)throw new T;this.isStopped=!0;for(var t=this.observers,e=t.length,n=t.slice(),r=0;r<e;r++)n[r].complete();this.observers.length=0},e.prototype.unsubscribe=function(){this.isStopped=!0,this.closed=!0,this.observers=null},e.prototype._trySubscribe=function(e){if(this.closed)throw new T;return t.prototype._trySubscribe.call(this,e)},e.prototype._subscribe=function(t){if(this.closed)throw new T;return this.hasError?(t.error(this.thrownError),f.EMPTY):this.isStopped?(t.complete(),f.EMPTY):(this.observers.push(t),new m(this,t))},e.prototype.asObservable=function(){var t=new A;return t.source=this,t},e.create=function(t,e){return new O(t,e)},e}(A),O=function(t){function e(e,n){var r=t.call(this)||this;return r.destination=e,r.source=n,r}return i(e,t),e.prototype.next=function(t){var e=this.destination;e&&e.next&&e.next(t)},e.prototype.error=function(t){var e=this.destination;e&&e.error&&this.destination.error(t)},e.prototype.complete=function(){var t=this.destination;t&&t.complete&&this.destination.complete()},e.prototype._subscribe=function(t){return this.source?this.source.subscribe(t):f.EMPTY},e}(N);function U(){return function(t){return t.lift(new L(t))}}var L=function(){function t(t){this.connectable=t}return t.prototype.call=function(t,e){var n=this.connectable;n._refCount++;var r=new P(t,n),i=e.subscribe(r);return r.closed||(r.connection=n.connect()),i},t}(),P=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return i(e,t),e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._refCount;if(e<=0)this.connection=null;else if(t._refCount=e-1,e>1)this.connection=null;else{var n=this.connection,r=t._connection;this.connection=null,!r||n&&r!==n||r.unsubscribe()}}else this.connection=null},e}(_),I=function(t){function e(e,n){var r=t.call(this)||this;return r.source=e,r.subjectFactory=n,r._refCount=0,r._isComplete=!1,r}return i(e,t),e.prototype._subscribe=function(t){return this.getSubject().subscribe(t)},e.prototype.getSubject=function(){var t=this._subject;return t&&!t.isStopped||(this._subject=this.subjectFactory()),this._subject},e.prototype.connect=function(){var t=this._connection;return t||(this._isComplete=!1,(t=this._connection=new f).add(this.source.subscribe(new G(this.getSubject(),this))),t.closed&&(this._connection=null,t=f.EMPTY)),t},e.prototype.refCount=function(){return U()(this)},e}(A),x=function(){var t=I.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:t._subscribe},_isComplete:{value:t._isComplete,writable:!0},getSubject:{value:t.getSubject},connect:{value:t.connect},refCount:{value:t.refCount}}}(),G=function(t){function e(e,n){var r=t.call(this,e)||this;return r.connectable=n,r}return i(e,t),e.prototype._error=function(e){this._unsubscribe(),t.prototype._error.call(this,e)},e.prototype._complete=function(){this.connectable._isComplete=!0,this._unsubscribe(),t.prototype._complete.call(this)},e.prototype._unsubscribe=function(){var t=this.connectable;if(t){this.connectable=null;var e=t._connection;t._refCount=0,t._subject=null,t._connection=null,e&&e.unsubscribe()}},e}(S),C=function(t){function e(e){var n=t.call(this)||this;return n._value=e,n}return i(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!0,configurable:!0}),e.prototype._subscribe=function(e){var n=t.prototype._subscribe.call(this,e);return n&&!n.closed&&e.next(this._value),n},e.prototype.getValue=function(){if(this.hasError)throw this.thrownError;if(this.closed)throw new T;return this._value},e.prototype.next=function(e){t.prototype.next.call(this,this._value=e)},e}(N),D=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r.pending=!1,r}return i(e,t),e.prototype.schedule=function(t,e){if(void 0===e&&(e=0),this.closed)return this;this.state=t;var n=this.id,r=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(r,n,e)),this.pending=!0,this.delay=e,this.id=this.id||this.requestAsyncId(r,this.id,e),this},e.prototype.requestAsyncId=function(t,e,n){return void 0===n&&(n=0),setInterval(t.flush.bind(t,this),n)},e.prototype.recycleAsyncId=function(t,e,n){if(void 0===n&&(n=0),null!==n&&this.delay===n&&!1===this.pending)return e;clearInterval(e)},e.prototype.execute=function(t,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(t,e);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(t,e){var n=!1,r=void 0;try{this.work(t)}catch(t){n=!0,r=!!t&&t||new Error(t)}if(n)return this.unsubscribe(),r},e.prototype._unsubscribe=function(){var t=this.id,e=this.scheduler,n=e.actions,r=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==r&&n.splice(r,1),null!=t&&(this.id=this.recycleAsyncId(e,t,null)),this.delay=null},e}(function(t){function e(e,n){return t.call(this)||this}return i(e,t),e.prototype.schedule=function(t,e){return this},e}(f)),R=function(t){function e(e,n){var r=t.call(this,e,n)||this;return r.scheduler=e,r.work=n,r}return i(e,t),e.prototype.schedule=function(e,n){return void 0===n&&(n=0),n>0?t.prototype.schedule.call(this,e,n):(this.delay=n,this.state=e,this.scheduler.flush(this),this)},e.prototype.execute=function(e,n){return n>0||this.closed?t.prototype.execute.call(this,e,n):this._execute(e,n)},e.prototype.requestAsyncId=function(e,n,r){return void 0===r&&(r=0),null!==r&&r>0||null===r&&this.delay>0?t.prototype.requestAsyncId.call(this,e,n,r):e.flush(this)},e}(D),H=function(){function t(e,n){void 0===n&&(n=t.now),this.SchedulerAction=e,this.now=n}return t.prototype.schedule=function(t,e,n){return void 0===e&&(e=0),new this.SchedulerAction(this,t).schedule(n,e)},t.now=function(){return Date.now()},t}(),k=function(t){function e(n,r){void 0===r&&(r=H.now);var i=t.call(this,n,(function(){return e.delegate&&e.delegate!==i?e.delegate.now():r()}))||this;return i.actions=[],i.active=!1,i.scheduled=void 0,i}return i(e,t),e.prototype.schedule=function(n,r,i){return void 0===r&&(r=0),e.delegate&&e.delegate!==this?e.delegate.schedule(n,r,i):t.prototype.schedule.call(this,n,r,i)},e.prototype.flush=function(t){var e=this.actions;if(this.active)e.push(t);else{var n;this.active=!0;do{if(n=t.execute(t.state,t.delay))break}while(t=e.shift());if(this.active=!1,n){for(;t=e.shift();)t.unsubscribe();throw n}}},e}(H),F=new(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e}(k))(R),Y=new A((function(t){return t.complete()}));function V(t){return t?function(t){return new A((function(e){return t.schedule((function(){return e.complete()}))}))}(t):Y}function B(t){return t&&"function"==typeof t.schedule}var M=function(t){return function(e){for(var n=0,r=t.length;n<r&&!e.closed;n++)e.next(t[n]);e.complete()}};function j(t,e){return new A((function(n){var r=new f,i=0;return r.add(e.schedule((function(){i!==t.length?(n.next(t[i++]),n.closed||r.add(this.schedule())):n.complete()}))),r}))}function K(t,e){return e?j(t,e):new A(M(t))}function W(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return B(n)?(t.pop(),j(t,n)):K(t)}function q(t,e){return new A(e?function(n){return e.schedule(z,0,{error:t,subscriber:n})}:function(e){return e.error(t)})}function z(t){var e=t.error;t.subscriber.error(e)}var $=function(){function t(t,e,n){this.kind=t,this.value=e,this.error=n,this.hasValue="N"===t}return t.prototype.observe=function(t){switch(this.kind){case"N":return t.next&&t.next(this.value);case"E":return t.error&&t.error(this.error);case"C":return t.complete&&t.complete()}},t.prototype.do=function(t,e,n){switch(this.kind){case"N":return t&&t(this.value);case"E":return e&&e(this.error);case"C":return n&&n()}},t.prototype.accept=function(t,e,n){return t&&"function"==typeof t.next?this.observe(t):this.do(t,e,n)},t.prototype.toObservable=function(){switch(this.kind){case"N":return W(this.value);case"E":return q(this.error);case"C":return V()}throw new Error("unexpected notification kind value")},t.createNext=function(e){return void 0!==e?new t("N",e):t.undefinedValueNotification},t.createError=function(e){return new t("E",void 0,e)},t.createComplete=function(){return t.completeNotification},t.completeNotification=new t("C"),t.undefinedValueNotification=new t("N",void 0),t}(),J=function(t){function e(e,n,r){void 0===r&&(r=0);var i=t.call(this,e)||this;return i.scheduler=n,i.delay=r,i}return i(e,t),e.dispatch=function(t){var e=t.notification,n=t.destination;e.observe(n),this.unsubscribe()},e.prototype.scheduleMessage=function(t){this.destination.add(this.scheduler.schedule(e.dispatch,this.delay,new X(t,this.destination)))},e.prototype._next=function(t){this.scheduleMessage($.createNext(t))},e.prototype._error=function(t){this.scheduleMessage($.createError(t)),this.unsubscribe()},e.prototype._complete=function(){this.scheduleMessage($.createComplete()),this.unsubscribe()},e}(_),X=function(){return function(t,e){this.notification=t,this.destination=e}}(),Q=function(t){function e(e,n,r){void 0===e&&(e=Number.POSITIVE_INFINITY),void 0===n&&(n=Number.POSITIVE_INFINITY);var i=t.call(this)||this;return i.scheduler=r,i._events=[],i._infiniteTimeWindow=!1,i._bufferSize=e<1?1:e,i._windowTime=n<1?1:n,n===Number.POSITIVE_INFINITY?(i._infiniteTimeWindow=!0,i.next=i.nextInfiniteTimeWindow):i.next=i.nextTimeWindow,i}return i(e,t),e.prototype.nextInfiniteTimeWindow=function(e){if(!this.isStopped){var n=this._events;n.push(e),n.length>this._bufferSize&&n.shift()}t.prototype.next.call(this,e)},e.prototype.nextTimeWindow=function(e){this.isStopped||(this._events.push(new Z(this._getNow(),e)),this._trimBufferThenGetEvents()),t.prototype.next.call(this,e)},e.prototype._subscribe=function(t){var e,n=this._infiniteTimeWindow,r=n?this._events:this._trimBufferThenGetEvents(),i=this.scheduler,o=r.length;if(this.closed)throw new T;if(this.isStopped||this.hasError?e=f.EMPTY:(this.observers.push(t),e=new m(this,t)),i&&t.add(t=new J(t,i)),n)for(var s=0;s<o&&!t.closed;s++)t.next(r[s]);else for(s=0;s<o&&!t.closed;s++)t.next(r[s].value);return this.hasError?t.error(this.thrownError):this.isStopped&&t.complete(),e},e.prototype._getNow=function(){return(this.scheduler||F).now()},e.prototype._trimBufferThenGetEvents=function(){for(var t=this._getNow(),e=this._bufferSize,n=this._windowTime,r=this._events,i=r.length,o=0;o<i&&!(t-r[o].time<n);)o++;return i>e&&(o=Math.max(o,i-e)),o>0&&r.splice(0,o),r},e}(N),Z=function(){return function(t,e){this.time=t,this.value=e}}(),tt=new k(D);function et(){}var nt=function(){function t(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return t.prototype=Object.create(Error.prototype),t}(),rt=function(){function t(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return t.prototype=Object.create(Error.prototype),t}(),it=function(){function t(){return Error.call(this),this.message="Timeout has occurred",this.name="TimeoutError",this}return t.prototype=Object.create(Error.prototype),t}();function ot(t,e){return function(n){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new st(t,e))}}var st=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new ut(t,this.project,this.thisArg))},t}(),ut=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.project=n,i.count=0,i.thisArg=r||i,i}return i(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(_),ct=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.notifyNext=function(t,e,n,r,i){this.destination.next(e)},e.prototype.notifyError=function(t,e){this.destination.error(t)},e.prototype.notifyComplete=function(t){this.destination.complete()},e}(_),at=function(t){function e(e,n,r){var i=t.call(this)||this;return i.parent=e,i.outerValue=n,i.outerIndex=r,i.index=0,i}return i(e,t),e.prototype._next=function(t){this.parent.notifyNext(this.outerValue,t,this.outerIndex,this.index++,this)},e.prototype._error=function(t){this.parent.notifyError(t,this),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(this),this.unsubscribe()},e}(_);function ht(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var lt=ht(),pt=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function ft(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var dt=function(t){if(t&&"function"==typeof t[y])return r=t,function(t){var e=r[y]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(pt(t))return M(t);if(ft(t))return n=t,function(t){return n.then((function(e){t.closed||(t.next(e),t.complete())}),(function(e){return t.error(e)})).then(null,c),t};if(t&&"function"==typeof t[lt])return e=t,function(t){for(var n=e[lt]();;){var r=void 0;try{r=n.next()}catch(e){return t.error(e),t}if(r.done){t.complete();break}if(t.next(r.value),t.closed)break}return"function"==typeof n.return&&t.add((function(){n.return&&n.return()})),t};var e,n,r,i=l(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+i+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function Et(t,e,n,r,i){if(void 0===i&&(i=new at(t,n,r)),!i.closed)return e instanceof A?e.subscribe(i):dt(e)(i)}function _t(t,e){if(null!=t){if(function(t){return t&&"function"==typeof t[y]}(t))return function(t,e){return new A((function(n){var r=new f;return r.add(e.schedule((function(){var i=t[y]();r.add(i.subscribe({next:function(t){r.add(e.schedule((function(){return n.next(t)})))},error:function(t){r.add(e.schedule((function(){return n.error(t)})))},complete:function(){r.add(e.schedule((function(){return n.complete()})))}}))}))),r}))}(t,e);if(ft(t))return function(t,e){return new A((function(n){var r=new f;return r.add(e.schedule((function(){return t.then((function(t){r.add(e.schedule((function(){n.next(t),r.add(e.schedule((function(){return n.complete()})))})))}),(function(t){r.add(e.schedule((function(){return n.error(t)})))}))}))),r}))}(t,e);if(pt(t))return j(t,e);if(function(t){return t&&"function"==typeof t[lt]}(t)||"string"==typeof t)return function(t,e){if(!t)throw new Error("Iterable cannot be null");return new A((function(n){var r,i=new f;return i.add((function(){r&&"function"==typeof r.return&&r.return()})),i.add(e.schedule((function(){r=t[lt](),i.add(e.schedule((function(){if(!n.closed){var t,e;try{var i=r.next();t=i.value,e=i.done}catch(t){return void n.error(t)}e?n.complete():(n.next(t),this.schedule())}})))}))),i}))}(t,e)}throw new TypeError((null!==t&&typeof t||t)+" is not observable")}function vt(t,e){return e?_t(t,e):t instanceof A?t:new A(dt(t))}var yt=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n}return i(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(_),bt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(_);function gt(t,e){if(!e.closed)return t instanceof A?t.subscribe(e):dt(t)(e)}function At(t,e,n){return void 0===n&&(n=Number.POSITIVE_INFINITY),"function"==typeof e?function(r){return r.pipe(At((function(n,r){return vt(t(n,r)).pipe(ot((function(t,i){return e(n,t,r,i)})))}),n))}:("number"==typeof e&&(n=e),function(e){return e.lift(new wt(t,n))})}var wt=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new Tt(t,this.project,this.concurrent))},t}(),Tt=function(t){function e(e,n,r){void 0===r&&(r=Number.POSITIVE_INFINITY);var i=t.call(this,e)||this;return i.project=n,i.concurrent=r,i.hasCompleted=!1,i.buffer=[],i.active=0,i.index=0,i}return i(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new yt(this),n=this.destination;n.add(e);var r=gt(t,e);r!==e&&n.add(r)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(bt);function mt(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),At(b,t)}function St(){return mt(1)}function Nt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return St()(W.apply(void 0,t))}function Ot(t){return new A((function(e){var n;try{n=t()}catch(t){return void e.error(t)}return(n?vt(n):V()).subscribe(e)}))}function Ut(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Number.POSITIVE_INFINITY,r=null,i=t[t.length-1];return B(i)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof i&&(n=t.pop()),null===r&&1===t.length&&t[0]instanceof A?t[0]:mt(n)(K(t,r))}var Lt=new A(et);function Pt(t,e){return function(n){return n.lift(new It(t,e))}}var It=function(){function t(t,e){this.predicate=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new xt(t,this.predicate,this.thisArg))},t}(),xt=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.predicate=n,i.thisArg=r,i.count=0,i}return i(e,t),e.prototype._next=function(t){var e;try{e=this.predicate.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}e&&this.destination.next(t)},e}(_);var Gt=function(){function t(t){this.resultSelector=t}return t.prototype.call=function(t,e){return e.subscribe(new Ct(t,this.resultSelector))},t}(),Ct=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.resultSelector=n,i.iterators=[],i.active=0,i.resultSelector="function"==typeof n?n:void 0,i}return i(e,t),e.prototype._next=function(t){var e=this.iterators;h(t)?e.push(new Rt(t)):"function"==typeof t[lt]?e.push(new Dt(t[lt]())):e.push(new Ht(this.destination,this,t))},e.prototype._complete=function(){var t=this.iterators,e=t.length;if(this.unsubscribe(),0!==e){this.active=e;for(var n=0;n<e;n++){var r=t[n];if(r.stillUnsubscribed)this.destination.add(r.subscribe());else this.active--}}else this.destination.complete()},e.prototype.notifyInactive=function(){this.active--,0===this.active&&this.destination.complete()},e.prototype.checkIterators=function(){for(var t=this.iterators,e=t.length,n=this.destination,r=0;r<e;r++){if("function"==typeof(s=t[r]).hasValue&&!s.hasValue())return}var i=!1,o=[];for(r=0;r<e;r++){var s,u=(s=t[r]).next();if(s.hasCompleted()&&(i=!0),u.done)return void n.complete();o.push(u.value)}this.resultSelector?this._tryresultSelector(o):n.next(o),i&&n.complete()},e.prototype._tryresultSelector=function(t){var e;try{e=this.resultSelector.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(_),Dt=function(){function t(t){this.iterator=t,this.nextResult=t.next()}return t.prototype.hasValue=function(){return!0},t.prototype.next=function(){var t=this.nextResult;return this.nextResult=this.iterator.next(),t},t.prototype.hasCompleted=function(){var t=this.nextResult;return Boolean(t&&t.done)},t}(),Rt=function(){function t(t){this.array=t,this.index=0,this.length=0,this.length=t.length}return t.prototype[lt]=function(){return this},t.prototype.next=function(t){var e=this.index++,n=this.array;return e<this.length?{value:n[e],done:!1}:{value:null,done:!0}},t.prototype.hasValue=function(){return this.array.length>this.index},t.prototype.hasCompleted=function(){return this.array.length===this.index},t}(),Ht=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.parent=n,i.observable=r,i.stillUnsubscribed=!0,i.buffer=[],i.isComplete=!1,i}return i(e,t),e.prototype[lt]=function(){return this},e.prototype.next=function(){var t=this.buffer;return 0===t.length&&this.isComplete?{value:null,done:!0}:{value:t.shift(),done:!1}},e.prototype.hasValue=function(){return this.buffer.length>0},e.prototype.hasCompleted=function(){return 0===this.buffer.length&&this.isComplete},e.prototype.notifyComplete=function(){this.buffer.length>0?(this.isComplete=!0,this.parent.notifyInactive()):this.destination.complete()},e.prototype.notifyNext=function(t){this.buffer.push(t),this.parent.checkIterators()},e.prototype.subscribe=function(){return gt(this.observable,new yt(this))},e}(bt);function kt(t){return function(e){var n=new Ft(t),r=e.lift(n);return n.caught=r}}var Ft=function(){function t(t){this.selector=t}return t.prototype.call=function(t,e){return e.subscribe(new Yt(t,this.selector,this.caught))},t}(),Yt=function(t){function e(e,n,r){var i=t.call(this,e)||this;return i.selector=n,i.caught=r,i}return i(e,t),e.prototype.error=function(e){if(!this.isStopped){var n=void 0;try{n=this.selector(e,this.caught)}catch(e){return void t.prototype.error.call(this,e)}this._unsubscribeAndRecycle();var r=new yt(this);this.add(r);var i=gt(n,r);i!==r&&this.add(i)}},e}(bt);function Vt(t){return void 0===t&&(t=null),function(e){return e.lift(new Bt(t))}}var Bt=function(){function t(t){this.defaultValue=t}return t.prototype.call=function(t,e){return e.subscribe(new Mt(t,this.defaultValue))},t}(),Mt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.defaultValue=n,r.isEmpty=!0,r}return i(e,t),e.prototype._next=function(t){this.isEmpty=!1,this.destination.next(t)},e.prototype._complete=function(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()},e}(_);function jt(t){return t instanceof Date&&!isNaN(+t)}function Kt(t){return void 0===t&&(t=zt),function(e){return e.lift(new Wt(t))}}var Wt=function(){function t(t){this.errorFactory=t}return t.prototype.call=function(t,e){return e.subscribe(new qt(t,this.errorFactory))},t}(),qt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.errorFactory=n,r.hasValue=!1,r}return i(e,t),e.prototype._next=function(t){this.hasValue=!0,this.destination.next(t)},e.prototype._complete=function(){if(this.hasValue)return this.destination.complete();var t=void 0;try{t=this.errorFactory()}catch(e){t=e}this.destination.error(t)},e}(_);function zt(){return new rt}function $t(t){return function(e){return 0===t?V():e.lift(new Jt(t))}}var Jt=function(){function t(t){if(this.total=t,this.total<0)throw new nt}return t.prototype.call=function(t,e){return e.subscribe(new Xt(t,this.total))},t}(),Xt=function(t){function e(e,n){var r=t.call(this,e)||this;return r.total=n,r.count=0,r}return i(e,t),e.prototype._next=function(t){var e=this.total,n=++this.count;n<=e&&(this.destination.next(t),n===e&&(this.destination.complete(),this.unsubscribe()))},e}(_);function Qt(t,e){var n=arguments.length>=2;return function(r){return r.pipe(t?Pt((function(e,n){return t(e,n,r)})):b,$t(1),n?Vt(e):Kt((function(){return new rt})))}}var Zt=function(){function t(t,e){this.subjectFactory=t,this.selector=e}return t.prototype.call=function(t,e){var n=this.selector,r=this.subjectFactory(),i=n(r).subscribe(t);return i.add(e.subscribe(r)),i},t}();function te(){return new N}function ee(){return function(t){return U()((e=te,function(t){var r;if(r="function"==typeof e?e:function(){return e},"function"==typeof n)return t.lift(new Zt(r,n));var i=Object.create(t,x);return i.source=t,i.subjectFactory=r,i})(t));var e,n}}function ne(t,e,n){var r;return r=t&&"object"==typeof t?t:{bufferSize:t,windowTime:e,refCount:!1,scheduler:n},function(t){return t.lift(function(t){var e,n,r=t.bufferSize,i=void 0===r?Number.POSITIVE_INFINITY:r,o=t.windowTime,s=void 0===o?Number.POSITIVE_INFINITY:o,u=t.refCount,c=t.scheduler,a=0,h=!1,l=!1;return function(t){var r;a++,!e||h?(h=!1,e=new Q(i,s,c),r=e.subscribe(this),n=t.subscribe({next:function(t){e.next(t)},error:function(t){h=!0,e.error(t)},complete:function(){l=!0,n=void 0,e.complete()}})):r=e.subscribe(this),this.add((function(){a--,r.unsubscribe(),n&&!l&&u&&0===a&&(n.unsubscribe(),n=void 0,e=void 0)}))}}(r))}}function re(t,e){return"function"==typeof e?function(n){return n.pipe(re((function(n,r){return vt(t(n,r)).pipe(ot((function(t,i){return e(n,t,r,i)})))})))}:function(e){return e.lift(new ie(t))}}var ie=function(){function t(t){this.project=t}return t.prototype.call=function(t,e){return e.subscribe(new oe(t,this.project))},t}(),oe=function(t){function e(e,n){var r=t.call(this,e)||this;return r.project=n,r.index=0,r}return i(e,t),e.prototype._next=function(t){var e,n=this.index++;try{e=this.project(t,n)}catch(t){return void this.destination.error(t)}this._innerSub(e)},e.prototype._innerSub=function(t){var e=this.innerSubscription;e&&e.unsubscribe();var n=new yt(this),r=this.destination;r.add(n),this.innerSubscription=gt(t,n),this.innerSubscription!==n&&r.add(this.innerSubscription)},e.prototype._complete=function(){var e=this.innerSubscription;e&&!e.closed||t.prototype._complete.call(this),this.unsubscribe()},e.prototype._unsubscribe=function(){this.innerSubscription=void 0},e.prototype.notifyComplete=function(){this.innerSubscription=void 0,this.isStopped&&t.prototype._complete.call(this)},e.prototype.notifyNext=function(t){this.destination.next(t)},e}(bt);function se(){return re(b)}function ue(t,e,n){return function(r){return r.lift(new ce(t,e,n))}}var ce=function(){function t(t,e,n){this.nextOrObserver=t,this.error=e,this.complete=n}return t.prototype.call=function(t,e){return e.subscribe(new ae(t,this.nextOrObserver,this.error,this.complete))},t}(),ae=function(t){function e(e,n,r,i){var s=t.call(this,e)||this;return s._tapNext=et,s._tapError=et,s._tapComplete=et,s._tapError=r||et,s._tapComplete=i||et,o(n)?(s._context=s,s._tapNext=n):n&&(s._context=n,s._tapNext=n.next||et,s._tapError=n.error||et,s._tapComplete=n.complete||et),s}return i(e,t),e.prototype._next=function(t){try{this._tapNext.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.next(t)},e.prototype._error=function(t){try{this._tapError.call(this._context,t)}catch(t){return void this.destination.error(t)}this.destination.error(t)},e.prototype._complete=function(){try{this._tapComplete.call(this._context)}catch(t){return void this.destination.error(t)}return this.destination.complete()},e}(_);var he=function(){function t(t,e,n,r){this.waitFor=t,this.absoluteTimeout=e,this.withObservable=n,this.scheduler=r}return t.prototype.call=function(t,e){return e.subscribe(new le(t,this.absoluteTimeout,this.waitFor,this.withObservable,this.scheduler))},t}(),le=function(t){function e(e,n,r,i,o){var s=t.call(this,e)||this;return s.absoluteTimeout=n,s.waitFor=r,s.withObservable=i,s.scheduler=o,s.scheduleTimeout(),s}return i(e,t),e.dispatchTimeout=function(t){var e=t.withObservable;t._unsubscribeAndRecycle(),t.add(gt(e,new yt(t)))},e.prototype.scheduleTimeout=function(){var t=this.action;t?this.action=t.schedule(this,this.waitFor):this.add(this.action=this.scheduler.schedule(e.dispatchTimeout,this.waitFor,this))},e.prototype._next=function(e){this.absoluteTimeout||this.scheduleTimeout(),t.prototype._next.call(this,e)},e.prototype._unsubscribe=function(){this.action=void 0,this.scheduler=null,this.withObservable=null},e}(bt);function pe(t,e){return void 0===e&&(e=tt),function(t,e,n){return void 0===n&&(n=tt),function(r){var i=jt(t),o=i?+t-n.now():Math.abs(t);return r.lift(new he(o,i,e,n))}}(t,q(new it),e)}var fe,de,Ee,_e,ve,ye,be=function(){function t(t,e){this.observables=t,this.project=e}return t.prototype.call=function(t,e){return e.subscribe(new ge(t,this.observables,this.project))},t}(),ge=function(t){function e(e,n,r){var i=t.call(this,e)||this;i.observables=n,i.project=r,i.toRespond=[];var o=n.length;i.values=new Array(o);for(var s=0;s<o;s++)i.toRespond.push(s);for(s=0;s<o;s++){var u=n[s];i.add(Et(i,u,void 0,s))}return i}return i(e,t),e.prototype.notifyNext=function(t,e,n){this.values[n]=e;var r=this.toRespond;if(r.length>0){var i=r.indexOf(n);-1!==i&&r.splice(i,1)}},e.prototype.notifyComplete=function(){},e.prototype._next=function(t){if(0===this.toRespond.length){var e=[t].concat(this.values);this.project?this._tryProject(e):this.destination.next(e)}},e.prototype._tryProject=function(t){var e;try{e=this.project.apply(this,t)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(ct);function Ae(t,e,n=fe.ERROR,r=de.JS_LIB){e?null==e||e.write({level:n,layer:r,message:t}):e||n!==fe.ERROR||console.error(t)}!function(t){t.ERROR="error",t.WARNING="warning",t.INFO="info"}(fe||(fe={})),function(t){t.CHROME_EXTENSION="chrome-extension",t.NATIVE_CONSOLE="native-console",t.JS_LIB="js-lib"}(de||(de={})),function(t){t.SDK_USAGE_ERROR="sdk-usage-error",t.FEATURE_NOT_SUPPORTED="feature-not-supported",t.DEVICE_ERROR="device-error",t.UNEXPECTED_ERROR="unexpected-error",t.INIT_ERROR="init-error"}(Ee||(Ee={}));class we extends Error{constructor(t,e){super(t),this.type=e,this.type=e,Object.setPrototypeOf(this,new.target.prototype)}}function Te(t){return e=>e.pipe(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return function(e){var n;"function"==typeof t[t.length-1]&&(n=t.pop());var r=t;return e.lift(new be(r,n))}}(t),Pt(([t,e])=>e),ot(([t,e])=>t))}!function(t){t[t.INPUT=0]="INPUT",t[t.OUTPUT=1]="OUTPUT",t[t.FEATURE=2]="FEATURE"}(_e||(_e={})),function(t){t.ABSOLUTE="absolute",t.RELATIVE="relative"}(ve||(ve={})),function(t){var e;(e=t.Type||(t.Type={}))[e.ATTACH=0]="ATTACH",e[e.DETACH=1]="DETACH"}(ye||(ye={}));class me{constructor(){this.type=null,this.id="",this.vid=0,this.pid=0,this.name="",this.descriptor=null}static deserialize(t){var e;const n=new me;return n.type="attach"===t.event?ye.Type.ATTACH:ye.Type.DETACH,n.id=t.id,n.pid=t.pid,n.vid=t.vid,n.name=t.name,n.type===ye.Type.ATTACH&&(n.descriptor=[],null===(e=t.descriptor)||void 0===e||e.forEach(t=>{var e;null===(e=n.descriptor)||void 0===e||e.push({reportType:this.convertToReportType(t.reportType),usagePage:t.usagePage,usage:t.usage,valueType:this.convertToValueType(t.valueType),reportSize:t.reportSize})})),n}static convertToReportType(t){switch(t){case"input":return _e.INPUT;case"output":return _e.OUTPUT;case"feature":return _e.FEATURE;default:throw new we(t+" is not a valid ReportType",Ee.UNEXPECTED_ERROR)}}static convertToValueType(t){switch(t){case"absolute":return ve.ABSOLUTE;case"relative":return ve.RELATIVE;default:throw new we(t+" Not a valid ValueType",Ee.UNEXPECTED_ERROR)}}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function Se(t,e,n){return t(n={path:e,exports:{},require:function(t,e){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==e&&n.path)}},n.exports),n.exports}var Ne,Oe,Ue,Le,Pe,Ie,xe,Ge,Ce,De,Re=Se((function(t){
/*!
**  Pure-UUID -- Pure JavaScript Based Universally Unique Identifier (UUID)
**  Copyright (c) 2004-2020 Dr. Ralf S. Engelschall <rse@engelschall.com>
**
**  Permission is hereby granted, free of charge, to any person obtaining
**  a copy of this software and associated documentation files (the
**  "Software"), to deal in the Software without restriction, including
**  without limitation the rights to use, copy, modify, merge, publish,
**  distribute, sublicense, and/or sell copies of the Software, and to
**  permit persons to whom the Software is furnished to do so, subject to
**  the following conditions:
**
**  The above copyright notice and this permission notice shall be included
**  in all copies or substantial portions of the Software.
**
**  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
**  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
**  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
**  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
**  CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
**  TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
**  SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/
t.exports=function(){var t=function(t,e,n,r,i,o){for(var s=function(t,e){var n=t.toString(16);return n.length<2&&(n="0"+n),e&&(n=n.toUpperCase()),n},u=e;u<=n;u++)i[o++]=s(t[u],r);return i},e=function(t,e,n,r,i){for(var o=e;o<=n;o+=2)r[i++]=parseInt(t.substr(o,2),16)},n="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ.-:+=^!/*?&<>()[]{}@%$#".split(""),r=[0,68,0,84,83,82,72,0,75,76,70,65,0,63,62,69,0,1,2,3,4,5,6,7,8,9,64,0,73,66,74,71,81,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,77,0,78,67,0,0,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,79,0,80,0,0],i=function(t,e){if(e%4!=0)throw new Error("z85_encode: invalid input length (multiple of 4 expected)");for(var r="",i=0,o=0;i<e;)if(o=256*o+t[i++],i%4==0){for(var s=52200625;s>=1;){var u=Math.floor(o/s)%85;r+=n[u],s/=85}o=0}return r},o=function(t,e){var n=t.length;if(n%5!=0)throw new Error("z85_decode: invalid input length (multiple of 5 expected)");void 0===e&&(e=new Array(4*n/5));for(var i=0,o=0,s=0;i<n;){var u=t.charCodeAt(i++)-32;if(u<0||u>=r.length)break;if(s=85*s+r[u],i%5==0){for(var c=16777216;c>=1;)e[o++]=Math.trunc(s/c%256),c/=256;s=0}}return e},s=function(t,e){var n={ibits:8,obits:8,obigendian:!0};for(var r in e)void 0!==n[r]&&(n[r]=e[r]);for(var i,o,s,u=[],c=0,a=0,h=0,l=t.length;0===a&&(o=t.charCodeAt(c++)),i=o>>n.ibits-(a+8)&255,a=(a+8)%n.ibits,n.obigendian?0===h?s=i<<n.obits-8:s|=i<<n.obits-8-h:0===h?s=i:s|=i<<h,!(0==(h=(h+8)%n.obits)&&(u.push(s),c>=l)););return u},u=function(t,e){var n={ibits:32,ibigendian:!0};for(var r in e)void 0!==n[r]&&(n[r]=e[r]);var i="",o=4294967295;n.ibits<32&&(o=(1<<n.ibits)-1);for(var s=t.length,u=0;u<s;u++)for(var c=t[u]&o,a=0;a<n.ibits;a+=8)n.ibigendian?i+=String.fromCharCode(c>>n.ibits-8-a&255):i+=String.fromCharCode(c>>a&255);return i},c=8,a=8,h=256,l=function(t,e,n,r,i,o,s,u){return[u,s,o,i,r,n,e,t]},p=function(){return l(0,0,0,0,0,0,0,0)},f=function(t){return t.slice(0)},d=function(t){for(var e=p(),n=0;n<c;n++)e[n]=Math.floor(t%h),t/=h;return e},E=function(t){for(var e=0,n=c-1;n>=0;n--)e*=h,e+=t[n];return Math.floor(e)},_=function(t,e){for(var n=0,r=0;r<c;r++)n+=t[r]+e[r],t[r]=Math.floor(n%h),n=Math.floor(n/h);return n},v=function(t,e){for(var n=0,r=0;r<c;r++)n+=t[r]*e,t[r]=Math.floor(n%h),n=Math.floor(n/h);return n},y=function(t,e){var n,r,i,o=new Array(c+c);for(n=0;n<c+c;n++)o[n]=0;for(n=0;n<c;n++){for(i=0,r=0;r<c;r++)i+=t[n]*e[r]+o[n+r],o[n+r]=i%h,i/=h;for(;r<c+c-n;r++)i+=o[n+r],o[n+r]=i%h,i/=h}for(n=0;n<c;n++)t[n]=o[n];return o.slice(c,c)},b=function(t,e){for(var n=0;n<c;n++)t[n]&=e[n];return t},g=function(t,e){for(var n=0;n<c;n++)t[n]|=e[n];return t},A=function(t,e){var n=p();if(e%a!=0)throw new Error("ui64_rorn: only bit rotations supported with a multiple of digit bits");for(var r=Math.floor(e/a),i=0;i<r;i++){for(var o=c-1-1;o>=0;o--)n[o+1]=n[o];for(n[0]=t[0],o=0;o<c-1;o++)t[o]=t[o+1];t[o]=0}return E(n)},w=function(t,e){if(e>c*a)throw new Error("ui64_ror: invalid number of bits to shift");var n,r=new Array(c+c);for(n=0;n<c;n++)r[n+c]=t[n],r[n]=0;var i=Math.floor(e/a),o=e%a;for(n=i;n<c+c-1;n++)r[n-i]=(r[n]>>>o|r[n+1]<<a-o)&(1<<a)-1;for(r[c+c-1-i]=r[c+c-1]>>>o&(1<<a)-1,n=c+c-1-i+1;n<c+c;n++)r[n]=0;for(n=0;n<c;n++)t[n]=r[n+c];return r.slice(0,c)},T=function(t,e){if(e>c*a)throw new Error("ui64_rol: invalid number of bits to shift");var n,r=new Array(c+c);for(n=0;n<c;n++)r[n+c]=0,r[n]=t[n];var i=Math.floor(e/a),o=e%a;for(n=c-1-i;n>0;n--)r[n+i]=(r[n]<<o|r[n-1]>>>a-o)&(1<<a)-1;for(r[0+i]=r[0]<<o&(1<<a)-1,n=0+i-1;n>=0;n--)r[n]=0;for(n=0;n<c;n++)t[n]=r[n];return r.slice(c,c)},m=function(t,e){for(var n=0;n<c;n++)t[n]^=e[n]},S=function(t,e){var n=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(n>>16)<<16|65535&n},N=function(t,e){return t<<e&4294967295|t>>>32-e&4294967295},O=function(t,e){function n(t,e,n,r){return t<20?e&n|~e&r:t<40?e^n^r:t<60?e&n|e&r|n&r:e^n^r}function r(t){return t<20?1518500249:t<40?1859775393:t<60?-1894007588:-899497514}t[e>>5]|=128<<24-e%32,t[15+(e+64>>9<<4)]=e;for(var i=Array(80),o=1732584193,s=-271733879,u=-1732584194,c=271733878,a=-1009589776,h=0;h<t.length;h+=16){for(var l=o,p=s,f=u,d=c,E=a,_=0;_<80;_++){i[_]=_<16?t[h+_]:N(i[_-3]^i[_-8]^i[_-14]^i[_-16],1);var v=S(S(N(o,5),n(_,s,u,c)),S(S(a,i[_]),r(_)));a=c,c=u,u=N(s,30),s=o,o=v}o=S(o,l),s=S(s,p),u=S(u,f),c=S(c,d),a=S(a,E)}return[o,s,u,c,a]},U=function(t){return u(O(s(t,{ibits:8,obits:32,obigendian:!0}),8*t.length),{ibits:32,ibigendian:!0})},L=function(t,e){function n(t,e,n,r,i,o){return S(N(S(S(e,t),S(r,o)),i),n)}function r(t,e,r,i,o,s,u){return n(e&r|~e&i,t,e,o,s,u)}function i(t,e,r,i,o,s,u){return n(e&i|r&~i,t,e,o,s,u)}function o(t,e,r,i,o,s,u){return n(e^r^i,t,e,o,s,u)}function s(t,e,r,i,o,s,u){return n(r^(e|~i),t,e,o,s,u)}t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var u=1732584193,c=-271733879,a=-1732584194,h=271733878,l=0;l<t.length;l+=16){var p=u,f=c,d=a,E=h;u=r(u,c,a,h,t[l+0],7,-680876936),h=r(h,u,c,a,t[l+1],12,-389564586),a=r(a,h,u,c,t[l+2],17,606105819),c=r(c,a,h,u,t[l+3],22,-1044525330),u=r(u,c,a,h,t[l+4],7,-176418897),h=r(h,u,c,a,t[l+5],12,1200080426),a=r(a,h,u,c,t[l+6],17,-1473231341),c=r(c,a,h,u,t[l+7],22,-45705983),u=r(u,c,a,h,t[l+8],7,1770035416),h=r(h,u,c,a,t[l+9],12,-1958414417),a=r(a,h,u,c,t[l+10],17,-42063),c=r(c,a,h,u,t[l+11],22,-1990404162),u=r(u,c,a,h,t[l+12],7,1804603682),h=r(h,u,c,a,t[l+13],12,-40341101),a=r(a,h,u,c,t[l+14],17,-1502002290),u=i(u,c=r(c,a,h,u,t[l+15],22,1236535329),a,h,t[l+1],5,-165796510),h=i(h,u,c,a,t[l+6],9,-1069501632),a=i(a,h,u,c,t[l+11],14,643717713),c=i(c,a,h,u,t[l+0],20,-373897302),u=i(u,c,a,h,t[l+5],5,-701558691),h=i(h,u,c,a,t[l+10],9,38016083),a=i(a,h,u,c,t[l+15],14,-660478335),c=i(c,a,h,u,t[l+4],20,-405537848),u=i(u,c,a,h,t[l+9],5,568446438),h=i(h,u,c,a,t[l+14],9,-1019803690),a=i(a,h,u,c,t[l+3],14,-187363961),c=i(c,a,h,u,t[l+8],20,1163531501),u=i(u,c,a,h,t[l+13],5,-1444681467),h=i(h,u,c,a,t[l+2],9,-51403784),a=i(a,h,u,c,t[l+7],14,1735328473),u=o(u,c=i(c,a,h,u,t[l+12],20,-1926607734),a,h,t[l+5],4,-378558),h=o(h,u,c,a,t[l+8],11,-2022574463),a=o(a,h,u,c,t[l+11],16,1839030562),c=o(c,a,h,u,t[l+14],23,-35309556),u=o(u,c,a,h,t[l+1],4,-1530992060),h=o(h,u,c,a,t[l+4],11,1272893353),a=o(a,h,u,c,t[l+7],16,-155497632),c=o(c,a,h,u,t[l+10],23,-1094730640),u=o(u,c,a,h,t[l+13],4,681279174),h=o(h,u,c,a,t[l+0],11,-358537222),a=o(a,h,u,c,t[l+3],16,-722521979),c=o(c,a,h,u,t[l+6],23,76029189),u=o(u,c,a,h,t[l+9],4,-640364487),h=o(h,u,c,a,t[l+12],11,-421815835),a=o(a,h,u,c,t[l+15],16,530742520),u=s(u,c=o(c,a,h,u,t[l+2],23,-995338651),a,h,t[l+0],6,-198630844),h=s(h,u,c,a,t[l+7],10,1126891415),a=s(a,h,u,c,t[l+14],15,-1416354905),c=s(c,a,h,u,t[l+5],21,-57434055),u=s(u,c,a,h,t[l+12],6,1700485571),h=s(h,u,c,a,t[l+3],10,-1894986606),a=s(a,h,u,c,t[l+10],15,-1051523),c=s(c,a,h,u,t[l+1],21,-2054922799),u=s(u,c,a,h,t[l+8],6,1873313359),h=s(h,u,c,a,t[l+15],10,-30611744),a=s(a,h,u,c,t[l+6],15,-1560198380),c=s(c,a,h,u,t[l+13],21,1309151649),u=s(u,c,a,h,t[l+4],6,-145523070),h=s(h,u,c,a,t[l+11],10,-1120210379),a=s(a,h,u,c,t[l+2],15,718787259),c=s(c,a,h,u,t[l+9],21,-343485551),u=S(u,p),c=S(c,f),a=S(a,d),h=S(h,E)}return[u,c,a,h]},P=function(t){return u(L(s(t,{ibits:8,obits:32,obigendian:!1}),8*t.length),{ibits:32,ibigendian:!1})},I=function(t){this.mul=l(88,81,244,45,76,149,127,45),this.inc=l(20,5,123,126,247,103,129,79),this.mask=l(0,0,0,0,255,255,255,255),this.state=f(this.inc),this.next(),b(this.state,this.mask),t=d(void 0!==t?t>>>0:4294967295*Math.random()>>>0),g(this.state,t),this.next()};I.prototype.next=function(){var t=f(this.state);y(this.state,this.mul),_(this.state,this.inc);var e=f(t);w(e,18),m(e,t),w(e,27);var n=f(t);w(n,59),b(e,this.mask);var r=E(n),i=f(e);return T(i,32-r),w(e,r),m(e,i),E(e)};var x=new I,G=function(t,e){for(var n=[],r=0;r<t;r++)n[r]=x.next()%e;return n},C=0,D=0,R=function(){if(1===arguments.length&&"string"==typeof arguments[0])this.parse.apply(this,arguments);else if(arguments.length>=1&&"number"==typeof arguments[0])this.make.apply(this,arguments);else{if(arguments.length>=1)throw new Error("UUID: constructor: invalid arguments");for(var t=0;t<16;t++)this[t]=0}};return"undefined"!=typeof Uint8Array?R.prototype=new Uint8Array(16):Buffer?R.prototype=Buffer.alloc(16):R.prototype=new Array(16),R.prototype.constructor=R,R.prototype.make=function(t){var e,n=this;if(1===t){var r=(new Date).getTime();r!==C?D=0:D++,C=r;var i,o=d(r);v(o,1e4),_(o,l(1,178,29,210,19,129,64,0)),D>0&&_(o,d(D)),i=A(o,8),n[3]=255&i,i=A(o,8),n[2]=255&i,i=A(o,8),n[1]=255&i,i=A(o,8),n[0]=255&i,i=A(o,8),n[5]=255&i,i=A(o,8),n[4]=255&i,i=A(o,8),n[7]=255&i,i=A(o,8),n[6]=15&i;var s=G(2,255);n[8]=s[0],n[9]=s[1];var u=G(6,255);for(u[0]|=1,u[0]|=2,e=0;e<6;e++)n[10+e]=u[e]}else if(4===t){var c=G(16,255);for(e=0;e<16;e++)this[e]=c[e]}else{if(3!==t&&5!==t)throw new Error("UUID: make: invalid version");var a="",h="object"==typeof arguments[1]&&arguments[1]instanceof R?arguments[1]:(new R).parse(arguments[1]);for(e=0;e<16;e++)a+=String.fromCharCode(h[e]);a+=arguments[2];var p=3===t?P(a):U(a);for(e=0;e<16;e++)n[e]=p.charCodeAt(e)}return n[6]&=15,n[6]|=t<<4,n[8]&=63,n[8]|=128,n},R.prototype.format=function(e){var n,r;return"z85"===e?n=i(this,16):"b16"===e?(r=Array(32),t(this,0,15,!0,r,0),n=r.join("")):void 0!==e&&"std"!==e||(r=new Array(36),t(this,0,3,!1,r,0),r[8]="-",t(this,4,5,!1,r,9),r[13]="-",t(this,6,7,!1,r,14),r[18]="-",t(this,8,9,!1,r,19),r[23]="-",t(this,10,15,!1,r,24),n=r.join("")),n},R.prototype.toString=function(t){return this.format(t)},R.prototype.toJSON=function(){return this.format("std")},R.prototype.parse=function(t,n){if("string"!=typeof t)throw new Error("UUID: parse: invalid argument (type string expected)");if("z85"===n)o(t,this);else if("b16"===n)e(t,0,35,this,0);else if(void 0===n||"std"===n){var r={nil:"00000000-0000-0000-0000-000000000000","ns:DNS":"6ba7b810-9dad-11d1-80b4-00c04fd430c8","ns:URL":"6ba7b811-9dad-11d1-80b4-00c04fd430c8","ns:OID":"6ba7b812-9dad-11d1-80b4-00c04fd430c8","ns:X500":"6ba7b814-9dad-11d1-80b4-00c04fd430c8"};if(void 0!==r[t])t=r[t];else if(!t.match(/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/))throw new Error('UUID: parse: invalid string representation (expected "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx")');e(t,0,7,this,0),e(t,9,12,this,4),e(t,14,17,this,6),e(t,19,22,this,8),e(t,24,35,this,10)}return this},R.prototype.export=function(){for(var t=Array(16),e=0;e<16;e++)t[e]=this[e];return t},R.prototype.import=function(t){if(!("object"==typeof t&&t instanceof Array))throw new Error("UUID: import: invalid argument (type Array expected)");if(16!==t.length)throw new Error("UUID: import: invalid argument (Array of length 16 expected)");for(var e=0;e<16;e++){if("number"!=typeof t[e])throw new Error("UUID: import: invalid array element #"+e+" (type Number expected)");if(!isFinite(t[e])||Math.floor(t[e])!==t[e])throw new Error("UUID: import: invalid array element #"+e+" (Number with integer value expected)");if(!(t[e]>=0&&t[e]<=255))throw new Error("UUID: import: invalid array element #"+e+" (Number with integer value in range 0...255 expected)");this[e]=t[e]}return this},R.prototype.compare=function(t){if("object"!=typeof t)throw new Error("UUID: compare: invalid argument (type UUID expected)");if(!(t instanceof R))throw new Error("UUID: compare: invalid argument (type UUID expected)");for(var e=0;e<16;e++){if(this[e]<t[e])return-1;if(this[e]>t[e])return 1}return 0},R.prototype.equal=function(t){return 0===this.compare(t)},R.prototype.fold=function(t){if(void 0===t)throw new Error("UUID: fold: invalid argument (number of fold operations expected)");if(t<1||t>4)throw new Error("UUID: fold: invalid argument (1-4 fold operations expected)");for(var e=16/Math.pow(2,t),n=new Array(e),r=0;r<e;r++){for(var i=0,o=0;r+o<16;o+=e)i^=this[r+o];n[r]=i}return n},R.PCG=I,R}(),t.exports.default=t.exports}));class He{constructor(t,e,n,r){this.id=t,this.usagePage=e,this.usage=n,this.value=r}isArray(){return Array.isArray(this.value)}static deserialize(t,e){return new He(t,e.usagePage,e.usage,e.value)}}class ke{constructor(t,e){this.devComm=t,this.logger=e,this.hidInputs=new A,this.consoleAppVersion=new A,this.chromeExtensionVersion=new A,this.isJabraDirectInstalled=null,this.softphoneInFocus=new A;const n=t.consoleAppEvent.pipe(Qt(t=>"ready"===t.event));n.subscribe(t=>{this.isJabraDirectInstalled=t.jabraDirectInstalled}),this.consoleAppVersion=n.pipe(ot(t=>t.version),pe(1e3),ne(1),kt(()=>W(null))),this.consoleAppVersion.subscribe(),this.chromeExtensionVersion=this.devComm.consoleAppEvent.pipe(Qt(t=>"chrome-extension-ready"===t.event),ot(t=>t.version),pe(1e3),ne(1),kt(()=>W(null))),this.chromeExtensionVersion.subscribe(),this.hidInputs=this.devComm.consoleAppEvent.pipe(Pt(t=>"hid-input"===t.event),ot(t=>He.deserialize(t.id,t))),this.deviceAttachDetach=this.devComm.consoleAppEvent.pipe(Pt(t=>"attach"===t.event||"detach"===t.event),ot(t=>me.deserialize(t))),this.gnpLockAcquired=this.devComm.consoleAppEvent.pipe(Pt(t=>"response-gnp-lock"===t.event),ot(t=>t.token)),this.callLockAcquiredResponse=this.devComm.consoleAppEvent.pipe(Pt(t=>"response-call-lock"===t.event),ot(t=>({device:t.id,acquired:t.acquired}))),this.devComm.consoleAppEvent.pipe(Pt(t=>"log"===t.event)).subscribe(t=>Ae(t.message,e,t.level,t.layer)),this.softphoneInFocus=this.devComm.consoleAppEvent.pipe(Pt(t=>"softphone-in-focus"===t.event),ot(t=>t.infocus),function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return B(n)?(t.pop(),function(e){return Nt(t,e,n)}):function(e){return Nt(t,e)}}(!1),ne(1)),this.softphoneInFocus.subscribe(()=>{})}writeHidReport(t){const e={action:"hid-output",id:t.id,usagePage:t.usagePage,usage:t.usage,value:t.value};return this.devComm.writeAction(e),!0}getFeatureReport(t,e,n){const r=new Re(4).toString(),i={action:"request-hid-feature",id:t,token:r,usagePage:e,usage:n};return this.devComm.writeAction(i),this.devComm.consoleAppEvent.pipe(Qt(t=>"response-hid-feature"===t.event&&t.token===r),ot(t=>t.value))}setFeatureReport(t){const e={action:"set-hid-feature",id:t.id,usagePage:t.usagePage,usage:t.usage,value:t.value};this.devComm.writeAction(e)}acquireGnpLock(t){const e=new Re(4).toString(),n={action:"request-gnp-lock",id:t,token:e};return this.devComm.writeAction(n),this.gnpLockAcquired.pipe(Qt(t=>t===e))}releaseGnpLock(t,e){const n={action:"release-gnp-lock",id:t,token:e};this.devComm.writeAction(n)}tryTakeCallLock(t){const e={action:"request-call-lock",id:t};return this.devComm.writeAction(e),this.callLockAcquiredResponse.pipe(Qt(e=>e.device===t),ot(t=>t.acquired))}releaseCallLock(t){const e={action:"release-call-lock",id:t};this.devComm.writeAction(e)}setSharedSoftphoneInfo(t){(new Re).parse(t.uuid);const e={action:"set-softphone-info",name:t.name,id:t.uuid};this.devComm.writeAction(e)}}class Fe{constructor(t,e){this.foundationLayer=t,this.sdkVersion="1.0.0",function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[t.length-1];return"function"==typeof n&&t.pop(),K(t,void 0).lift(new Gt(n))}(this.consoleAppVersion,this.chromeExtensionVersion).subscribe(t=>{Ae(`sdkVersion: ${this.sdkVersion} | chromeHostVersion: ${t[0]} | chromeExtensionVersion: ${t[1]} | nodeVersion: ${this.nodeVersion} | browserUserAgent: ${this.browserUserAgent}`,e,fe.INFO)})}get consoleAppVersion(){return this.foundationLayer.consoleAppVersion}get chromeExtensionVersion(){return this.foundationLayer.chromeExtensionVersion}get browserUserAgent(){return"undefined"!=typeof window?window.navigator.userAgent:null}get nodeVersion(){return"undefined"!=typeof process?process.version:null}}class Ye{constructor(t,e,n,r,i,o=new Uint8Array,s=0){this.destination=t,this.source=e,this.type=n,this.command=r,this.subCommand=i,this.payload=o,this.sequenceNumber=s}}!function(t){t[t.PC_ADDR=0]="PC_ADDR",t[t.BASE_ADDR=1]="BASE_ADDR",t[t.HS1_ADDR=4]="HS1_ADDR",t[t.HS_BT_USB_ADDR=8]="HS_BT_USB_ADDR",t[t.HS_CRADLE_ADDR=10]="HS_CRADLE_ADDR",t[t.CRADLE_ADDR=21]="CRADLE_ADDR"}(Ne||(Ne={})),function(t){t[t.EVENT=0]="EVENT",t[t.READ=1]="READ",t[t.WRITE=2]="WRITE",t[t.REPLY=3]="REPLY"}(Oe||(Oe={})),function(t){t[t.IDENT=2]="IDENT",t[t.DFU=7]="DFU",t[t.DEVICE=13]="DEVICE",t[t.FWU=15]="FWU",t[t.STATUS=18]="STATUS",t[t.CONFIG=19]="CONFIG",t[t.NACK=254]="NACK",t[t.ACK=255]="ACK"}(Ue||(Ue={})),function(t){t[t.CONFIG_PREFERRED_SOFTPHONE=34]="CONFIG_PREFERRED_SOFTPHONE",t[t.IDENT_TYPE=2]="IDENT_TYPE",t[t.IDENT_GET_AVAILABLE_SOFTPHONES=16]="IDENT_GET_AVAILABLE_SOFTPHONES"}(Le||(Le={})),function(t){t[t.USAGE_PAGE_LED=8]="USAGE_PAGE_LED",t[t.USAGE_PAGE_BUTTON=9]="USAGE_PAGE_BUTTON",t[t.USAGE_PAGE_TELEPHONY=11]="USAGE_PAGE_TELEPHONY",t[t.USAGE_PAGE_CONSUMER=12]="USAGE_PAGE_CONSUMER",t[t.USAGE_PAGE_GN_PROTOCOL=65280]="USAGE_PAGE_GN_PROTOCOL",t[t.USAGE_PAGE_GN_CONSUMER=65312]="USAGE_PAGE_GN_CONSUMER",t[t.USAGE_PAGE_GN_TELEPHONY=65328]="USAGE_PAGE_GN_TELEPHONY",t[t.USAGE_PAGE_GN_LED=65344]="USAGE_PAGE_GN_LED",t[t.USAGE_PAGE_GN_EXT_BUTTONS=65360]="USAGE_PAGE_GN_EXT_BUTTONS",t[t.USAGE_PAGE_GN_MISC=65376]="USAGE_PAGE_GN_MISC"}(Pe||(Pe={})),function(t){t[t.USAGE_GN_DATA=1]="USAGE_GN_DATA",t[t.USAGE_LED_OFF_HOOK=23]="USAGE_LED_OFF_HOOK",t[t.USAGE_LED_MIC_MUTE=33]="USAGE_LED_MIC_MUTE",t[t.USAGE_LED_ONLINE=42]="USAGE_LED_ONLINE",t[t.USAGE_LED_OFFLINE=43]="USAGE_LED_OFFLINE",t[t.USAGE_LED_MUTE=9]="USAGE_LED_MUTE",t[t.USAGE_LED_RING=24]="USAGE_LED_RING",t[t.USAGE_LED_MESSAGE_WAIT=25]="USAGE_LED_MESSAGE_WAIT",t[t.USAGE_LED_HOLD=32]="USAGE_LED_HOLD",t[t.USAGE_TELEPHONY_CONT_SET=65535]="USAGE_TELEPHONY_CONT_SET"}(Ie||(Ie={})),function(t){t[t.USAGE_TEL_HOOK_SWITCH=32]="USAGE_TEL_HOOK_SWITCH",t[t.USAGE_TEL_FLASH=33]="USAGE_TEL_FLASH",t[t.USAGE_TEL_HOLD=35]="USAGE_TEL_HOLD",t[t.USAGE_TEL_REDIAL=36]="USAGE_TEL_REDIAL",t[t.USAGE_TEL_ONLINE=42]="USAGE_TEL_ONLINE",t[t.USAGE_TEL_SPEAKER_PHONE=43]="USAGE_TEL_SPEAKER_PHONE",t[t.USAGE_TEL_PHONE_MUTE=47]="USAGE_TEL_PHONE_MUTE",t[t.USAGE_TEL_PHONE_SEND=49]="USAGE_TEL_PHONE_SEND",t[t.USAGE_TEL_SPEED_DIAL=80]="USAGE_TEL_SPEED_DIAL",t[t.USAGE_TEL_VOICE_MAIL=112]="USAGE_TEL_VOICE_MAIL",t[t.USAGE_TEL_ANSWER_ON_OFF=116]="USAGE_TEL_ANSWER_ON_OFF",t[t.USAGE_TEL_LINE_BUSY=151]="USAGE_TEL_LINE_BUSY",t[t.USAGE_TEL_RINGER=158]="USAGE_TEL_RINGER",t[t.USAGE_TEL_PHONE_KEY_0=176]="USAGE_TEL_PHONE_KEY_0",t[t.USAGE_TEL_PHONE_KEY_1=177]="USAGE_TEL_PHONE_KEY_1",t[t.USAGE_TEL_PHONE_KEY_2=178]="USAGE_TEL_PHONE_KEY_2",t[t.USAGE_TEL_PHONE_KEY_3=179]="USAGE_TEL_PHONE_KEY_3",t[t.USAGE_TEL_PHONE_KEY_4=180]="USAGE_TEL_PHONE_KEY_4",t[t.USAGE_TEL_PHONE_KEY_5=181]="USAGE_TEL_PHONE_KEY_5",t[t.USAGE_TEL_PHONE_KEY_6=182]="USAGE_TEL_PHONE_KEY_6",t[t.USAGE_TEL_PHONE_KEY_7=183]="USAGE_TEL_PHONE_KEY_7",t[t.USAGE_TEL_PHONE_KEY_8=184]="USAGE_TEL_PHONE_KEY_8",t[t.USAGE_TEL_PHONE_KEY_9=185]="USAGE_TEL_PHONE_KEY_9",t[t.USAGE_TEL_PHONE_KEY_STAR=186]="USAGE_TEL_PHONE_KEY_STAR",t[t.USAGE_TEL_PHONE_KEY_POUND=187]="USAGE_TEL_PHONE_KEY_POUND",t[t.USAGE_TEL_ALT_VOLUME_UP=233]="USAGE_TEL_ALT_VOLUME_UP",t[t.USAGE_TEL_ALT_VOLUME_DOWN=234]="USAGE_TEL_ALT_VOLUME_DOWN",t[t.USAGE_GN_REJECT_CALL=65533]="USAGE_GN_REJECT_CALL"}(xe||(xe={})),function(t){t[t.MS_OC=0]="MS_OC",t[t.CISCO=1]="CISCO",t[t.AVAYA=2]="AVAYA",t[t.SIEMENS=3]="SIEMENS",t[t.ALCATEL=4]="ALCATEL",t[t.IBM=5]="IBM",t[t.AASTRA=6]="AASTRA",t[t.SKYPE=7]="SKYPE",t[t.GENERIC=8]="GENERIC",t[t.NORTEL=9]="NORTEL",t[t.JABRA=10]="JABRA",t[t.NEC=11]="NEC",t[t.SHORETEL=12]="SHORETEL",t[t.OTHER=255]="OTHER"}(Ge||(Ge={}));class Ve{constructor(){this.command=Ue.IDENT,this.subCommand=Le.IDENT_TYPE,this.deserialize=t=>t.source}}class Be{constructor(){var t;this.command=Ue.IDENT,this.subCommand=Le.IDENT_GET_AVAILABLE_SOFTPHONES,this.deserialize=(t=t=>t,e=>{const n=e.payload,r=n[0],i=n.length-1;if(i!==r)throw new we(`Invalid response. Expected length: ${r}, actual: ${i}`,Ee.DEVICE_ERROR);const o=[];return n.slice(1).forEach(e=>{o.push(t(e))}),o})}}class Me{constructor(){this.command=Ue.CONFIG,this.subCommand=Le.CONFIG_PREFERRED_SOFTPHONE,this.deserialize=t=>t.payload[0],this.serialize=t=>Uint8Array.of(t)}}!function(t){t[t.HOOK_SWITCH=32]="HOOK_SWITCH",t[t.FLASH=33]="FLASH",t[t.ALT_HOLD=35]="ALT_HOLD",t[t.REDIAL=36]="REDIAL",t[t.ONLINE=42]="ONLINE",t[t.SPEAKER_PHONE=43]="SPEAKER_PHONE",t[t.PHONE_MUTE=47]="PHONE_MUTE",t[t.SEND=49]="SEND",t[t.SPEED_DIAL=80]="SPEED_DIAL",t[t.VOICE_MAIL=112]="VOICE_MAIL",t[t.ANSWER_ON_OFF=116]="ANSWER_ON_OFF",t[t.LINE_BUSY=151]="LINE_BUSY",t[t.RINGER=158]="RINGER",t[t.PHONE_KEY_0=176]="PHONE_KEY_0",t[t.PHONE_KEY_1=177]="PHONE_KEY_1",t[t.PHONE_KEY_2=178]="PHONE_KEY_2",t[t.PHONE_KEY_3=179]="PHONE_KEY_3",t[t.PHONE_KEY_4=180]="PHONE_KEY_4",t[t.PHONE_KEY_5=181]="PHONE_KEY_5",t[t.PHONE_KEY_6=182]="PHONE_KEY_6",t[t.PHONE_KEY_7=183]="PHONE_KEY_7",t[t.PHONE_KEY_8=184]="PHONE_KEY_8",t[t.PHONE_KEY_9=185]="PHONE_KEY_9",t[t.PHONE_KEY_STAR=186]="PHONE_KEY_STAR",t[t.PHONE_KEY_POUND=187]="PHONE_KEY_POUND",t[t.ALT_VOLUME_UP=233]="ALT_VOLUME_UP",t[t.ALT_VOLUME_DOWN=234]="ALT_VOLUME_DOWN",t[t.REJECT_CALL=65533]="REJECT_CALL"}(Ce||(Ce={}));class je{constructor(t,e,n){this.type=t,this.value=e,this.valueType=n}toString(){return void 0===Ce[this.type]?`Unknown signal: type: ${this.type}, value: ${this.value}, valueType: ${this.valueType}`:`Signal: type: ${Ce[this.type]}, value: ${this.value}, valueType: ${this.valueType}`}}class Ke{constructor(t,e,n,r){this.hidChannel=t,this.isSoftphoneInFocus=e,this.callLockHeld=n,this.logger=r,this.cachedSignals=new Map,this.lockHeld=new C(!1),this.callLockHeld.subscribe(this.lockHeld)}setup(){const t=this.filter().pipe(ee());return t.subscribe(t=>this.cachedSignals.set(t.type,t.value)),t}filter(){const t=this.hidChannel.input.pipe(Pt(t=>t.usagePage===Pe.USAGE_PAGE_GN_TELEPHONY&&!t.isArray())),e=[Ce.HOOK_SWITCH,Ce.REDIAL];return Ut(t.pipe(Te(this.isSoftphoneInFocus),Pt(t=>e.includes(t.usage)&&!this.lockHeld.getValue())),t.pipe(Pt(t=>this.lockHeld.getValue()))).pipe(ot(t=>{const e=this.hidChannel.descriptor.find(e=>e.usagePage===t.usagePage&&e.usage===t.usage);if(!(null==e?void 0:e.valueType))throw new we(`Unable to find value-type in descriptor for UsagePage: ${t.usagePage} and Usage: ${t.usage}`,Ee.FEATURE_NOT_SUPPORTED);return Object.assign(Object.assign({},t),{valueType:e.valueType})}),Pt(t=>{if(t.valueType===ve.RELATIVE)return Boolean(t.value);return this.cachedSignals.get(t.usage)!==Boolean(t.value)}),ot(t=>new je(t.usage,0!==t.value,t.valueType)),kt(t=>(Ae(t.message,this.logger),Y)))}}class We{constructor(t,e,n,r,i){this.hidChannel=t,this.callLock=e,this.deviceId=n,this.callLockHeld=new C(!1),this.deviceSignals=new N;const o=new Ke(t,r,this.callLockHeld.asObservable(),i);this.deviceSignals=o.setup()}checkCallLockHeld(t){if(!this.callLockHeld.getValue())throw new we(t,Ee.SDK_USAGE_ERROR)}checkCallLockNotHeld(t){if(this.callLockHeld.getValue())throw new we(t,Ee.SDK_USAGE_ERROR)}getCallLock(){this.checkCallLockNotHeld("Trying to take the call lock, but it is already held!");return Ot(()=>this.callLock.tryTakeCallLock(this.deviceId)).pipe(ue(t=>{this.callLockHeld.next(t)}))}releaseCallLock(){this.checkCallLockHeld("Trying to release the call lock, but it is not held!"),this.callLockHeld.next(!1),this.callLock.releaseCallLock(this.deviceId)}offHook(t){this.checkCallLockHeld("Calls can only be started and stopped when the call lock is held.");const e=this.hidChannel.findDescriptor(Pe.USAGE_PAGE_GN_LED,Ie.USAGE_LED_OFF_HOOK,_e.OUTPUT);if(!e)throw new we("The device does not support any mute functionality.",Ee.FEATURE_NOT_SUPPORTED);const n=t?1:0;this.hidChannel.output(e.usagePage,e.usage,n)}ring(t){this.checkCallLockHeld("The ringer state can only be modified when the call lock is held.");const e=this.hidChannel.findDescriptor(Pe.USAGE_PAGE_GN_LED,Ie.USAGE_LED_RING,_e.OUTPUT),n=this.hidChannel.findDescriptor(Pe.USAGE_PAGE_GN_TELEPHONY,xe.USAGE_TEL_RINGER,_e.OUTPUT);if(!e&&!n)throw new we("The device does not support any ringer functionality.",Ee.FEATURE_NOT_SUPPORTED);if(e){const n=t?1:0;this.hidChannel.output(e.usagePage,e.usage,n)}if(n){const e=t?1:0;this.hidChannel.output(n.usagePage,n.usage,e)}}mute(t){this.checkCallLockHeld("The mute state can only be modified when the call lock is held.");let e=this.hidChannel.findDescriptor(Pe.USAGE_PAGE_GN_LED,Ie.USAGE_LED_MIC_MUTE,_e.OUTPUT);if(e||(e=this.hidChannel.findDescriptor(Pe.USAGE_PAGE_GN_LED,Ie.USAGE_LED_MUTE,_e.OUTPUT)),!e)throw new we("The device does not support any mute functionality.",Ee.FEATURE_NOT_SUPPORTED);const n=t?1:0;this.hidChannel.output(e.usagePage,e.usage,n)}hold(t){this.checkCallLockHeld("The hold state can only be modified when the call lock is held.");const e=this.hidChannel.findDescriptor(Pe.USAGE_PAGE_GN_LED,Ie.USAGE_LED_HOLD,_e.OUTPUT);if(!e)throw new we("The device does not support any mute functionality.",Ee.FEATURE_NOT_SUPPORTED);const n=t?1:0;this.hidChannel.output(e.usagePage,e.usage,n)}}class qe{constructor(t,e,n){this.deviceId=t,this.descriptor=e,this.foundationLayer=n,this.input=n.hidInputs.pipe(Pt(e=>e.id===t))}output(t,e,n){const r=new He(this.deviceId,t,e,n);this.foundationLayer.writeHidReport(r)}setFeatureReport(t,e,n){const r=new He(this.deviceId,t,e,n);this.foundationLayer.setFeatureReport(r)}findDescriptor(t,e,n){return this.descriptor.find(r=>r.usagePage===t&&r.usage===e&&r.reportType===n)}}class ze{constructor(t,e,n,r,i,o,s){this.gnpChannel=t,this.hidChannel=e,this.callLock=n,this.vendorId=r,this.productId=i,this.id=o,this.name=s}supportsCallControl(){return[{usagePage:Pe.USAGE_PAGE_GN_LED,usage:Ie.USAGE_LED_OFF_HOOK,reportType:_e.OUTPUT},{usagePage:Pe.USAGE_PAGE_GN_LED,usage:Ie.USAGE_LED_RING,reportType:_e.OUTPUT},{usagePage:Pe.USAGE_PAGE_GN_TELEPHONY,usage:xe.USAGE_TEL_RINGER,reportType:_e.OUTPUT},{usagePage:Pe.USAGE_PAGE_GN_LED,usage:Ie.USAGE_LED_MIC_MUTE,reportType:_e.OUTPUT},{usagePage:Pe.USAGE_PAGE_GN_LED,usage:Ie.USAGE_LED_MUTE,reportType:_e.OUTPUT},{usagePage:Pe.USAGE_PAGE_GN_LED,usage:Ie.USAGE_LED_HOLD,reportType:_e.OUTPUT}].some(t=>this.hidChannel.findDescriptor(t.usagePage,t.usage,t.reportType))}}!function(t){t[t.STD_TELEPHONY=0]="STD_TELEPHONY",t[t.GN_TELEPHONY=1]="GN_TELEPHONY"}(De||(De={}));const $e={[Ge.SKYPE]:De.GN_TELEPHONY,[Ge.CISCO]:De.GN_TELEPHONY,[Ge.AVAYA]:De.GN_TELEPHONY,[Ge.SIEMENS]:De.GN_TELEPHONY,[Ge.IBM]:De.GN_TELEPHONY,[Ge.AASTRA]:De.GN_TELEPHONY,[Ge.JABRA]:De.GN_TELEPHONY,[Ge.NEC]:De.GN_TELEPHONY,[Ge.SHORETEL]:De.GN_TELEPHONY,[Ge.MS_OC]:De.STD_TELEPHONY,[Ge.ALCATEL]:De.STD_TELEPHONY,[Ge.OTHER]:De.STD_TELEPHONY,[Ge.NORTEL]:null,[Ge.GENERIC]:null};function Je(t,e,n){const r=t.read(new Me,e).pipe(ot(t=>$e[t]===n)),i=t.read(new Be,e).pipe(ot(t=>t.find(t=>$e[t]===n))).pipe(ot(n=>n?t.write(new Me,n,e):W(!1)),se());return r.pipe((o=W(!0),s=i,t=>t.pipe(ot(t=>t?o:s),se())));var o,s}class Xe{static typeFromAttr(t){return t>>6}static packetLengthFromAttr(t){return t&this.lengthMask}static deserialize(t){const e=t[0],n=t[1],r=t[2],i=this.typeFromAttr(t[3]),o=t[4],s=t[5],u=this.packetLengthFromAttr(t[3]),c=t.slice(6,u);return new Ye(e,n,i,o,s,c,r)}}Xe.lengthMask=63;class Qe{constructor(){this.data=[]}hasHeader(){return this.data.length>=Qe.gnpPacketHeaderLength}expectedPacketLength(){if(!this.hasHeader())throw new we("Unable to get expected packet length without a full header",Ee.UNEXPECTED_ERROR);return Xe.packetLengthFromAttr(this.data[3])}appendData(t){this.hasHeader()&&this.expectedPacketLength()>Qe.gnpPacketMaxLength&&(this.data=[]),this.data=this.data.concat(t)}hasFullPacket(){if(!this.hasHeader())return!1;const t=this.expectedPacketLength();return this.data.length>=t}getPacketAndReset(){if(!this.hasFullPacket())throw new we("Trying to get packet but buffer is not complete",Ee.UNEXPECTED_ERROR);const t=Xe.deserialize(Uint8Array.from(this.data));return this.data=[],t}}Qe.gnpPacketHeaderLength=6,Qe.gnpPacketMaxLength=63;const Ze=()=>{};function tn(t){return ue(e=>t(),e=>t(),()=>Ze)}const en=()=>{return t=t=>t.command===Ue.NACK,e=t=>new we("Got NACK response. Reason: "+t.subCommand,Ee.DEVICE_ERROR),n=>n.pipe(ot(n=>t(n)?q(e(n)):W(n)),se());var t,e},nn=t=>Qt(e=>e.type===Oe.REPLY&&e.sequenceNumber===t.sequenceNumber&&e.destination===t.source&&e.source===t.destination);class rn{constructor(t,e,n,r){this.hidChannel=t,this.gnpLock=e,this.deviceId=n,this.primaryAddress=r,this.nextSequenceNumber=0,this.lockQueue=[],this.packets=rn.setupInputParsing(t.input),this.events=rn.setupEventFiltering(this.packets)}static setupInputParsing(t){const e=t.pipe(Pt(t=>t.usagePage===Pe.USAGE_PAGE_GN_PROTOCOL&&t.usage===Ie.USAGE_GN_DATA&&t.isArray())),n=new Qe;return e.pipe(At(t=>{const e=t.value;if(n.appendData(e),n.hasFullPacket()){return W(n.getPacketAndReset())}return Lt}),ee())}static setupEventFiltering(t){return t.pipe(Pt(t=>t.type===Oe.EVENT))}getNextSequenceNumber(){const t=this.nextSequenceNumber;return this.nextSequenceNumber=(this.nextSequenceNumber+1)%255,t}doWithGnpLockHeld(t){this.lockQueue.push(t),this.lockQueue.length>1||this.processLockQueue()}processLockQueue(){this.gnpLock.acquireGnpLock(this.deviceId).subscribe(t=>{(0,this.lockQueue[0])(t=>{var e;const n=null===(e=this.hidChannel.findDescriptor(Pe.USAGE_PAGE_GN_PROTOCOL,Ie.USAGE_GN_DATA,_e.OUTPUT))||void 0===e?void 0:e.reportSize;if(!n)throw new we("Cannot send GNP packets to this device.",Ee.DEVICE_ERROR);const r=class{static attrFromTypeAndPayloadLength(t,e){return(t<<6)+(e+6)}static serialize(t){const e=new Uint8Array(6);e[0]=t.destination,e[1]=t.source,e[2]=t.sequenceNumber,e[3]=this.attrFromTypeAndPayloadLength(t.type,t.payload.length),e[4]=t.command,e[5]=t.subCommand;const n=new Uint8Array(e.length+t.payload.length);return n.set(e),n.set(t.payload,e.length),n}}.serialize(t);let i=0;do{const t=Math.min(r.length-i,n),e=r.subarray(i,i+t);i+=e.length,this.hidChannel.output(Pe.USAGE_PAGE_GN_PROTOCOL,Ie.USAGE_GN_DATA,Array.from(e))}while(i<r.length)},this.packets,()=>{this.gnpLock.releaseGnpLock(this.deviceId,t),this.lockQueue.splice(0,1),this.lockQueue.length>0&&this.processLockQueue()})})}sendEvent(t,e,n){const r=new Ye(n,Ne.PC_ADDR,Oe.EVENT,t.command,t.subCommand,t.serialize(e),0);this.doWithGnpLockHeld((t,e,n)=>{t(r),n()})}read(t,e,n=2500){const r=new Ye(e,Ne.PC_ADDR,Oe.READ,t.command,t.subCommand,new Uint8Array,this.getNextSequenceNumber()),i=new N;return this.doWithGnpLockHeld((e,o,s)=>{o.pipe(nn(r),en(),Qt(t=>t.command===r.command&&t.subCommand===r.subCommand),pe(n),tn(s),ot(e=>t.deserialize(e))).subscribe(i),e(r)}),i}write(t,e,n,r=2500){const i=new Ye(n,Ne.PC_ADDR,Oe.WRITE,t.command,t.subCommand,t.serialize(e),this.getNextSequenceNumber()),o=new N;return this.doWithGnpLockHeld((t,e,n)=>{e.pipe(nn(i),en(),Qt(t=>t.command===Ue.ACK),pe(r),tn(n),ot(()=>!0)).subscribe(o),t(i)}),o}}function on(t,e,n,r=fe.ERROR,i=de.JS_LIB){Ae(`${t} ${function(t){if(t instanceof we){const e=t;return`JabraError: ${e.message} (type: ${e.type})`}if(t instanceof Error){const e=t;return`Error: ${e.message} (name: ${e.name})`}return"Unknown error: "+t}(e)}`,n,r,i)}function sn(t,e,n){var r,i;const o=e.id,s=new qe(o,null!==(r=e.descriptor)&&void 0!==r?r:[],t),u=function(t,e,n){return t.findDescriptor(Pe.USAGE_PAGE_GN_PROTOCOL,Ie.USAGE_GN_DATA,_e.OUTPUT)?W(Ne.HS_BT_USB_ADDR,Ne.BASE_ADDR,Ne.CRADLE_ADDR,Ne.HS1_ADDR,Ne.HS_CRADLE_ADDR).pipe(ot(r=>Ot(()=>{const i=new rn(t,e,n,r),o=new Ve;return i.read(o,r,500).pipe(ot(t=>i))})),kt(()=>Y),St(),$t(1),Kt(()=>new we("GNP probe failed.",Ee.DEVICE_ERROR))):q(new we("Device does not support GNP commands.",Ee.DEVICE_ERROR))}(s,t,o),c=null!==(i=t.isJabraDirectInstalled)&&void 0!==i&&i;return u.pipe(kt(t=>(on("Failed to set up GNP, falling back to HID. Error: ",t,n,fe.INFO,de.JS_LIB),W(void 0))),ot(n=>new ze(n,s,t,e.vid,e.pid,o,e.name))).pipe(At(t=>{return e=()=>c,r=W(t),i=function(t){const{hidChannel:e,gnpChannel:n}=t;return e.findDescriptor(Pe.USAGE_PAGE_GN_TELEPHONY,Ie.USAGE_TELEPHONY_CONT_SET,_e.FEATURE)?Ot(()=>(e.setFeatureReport(Pe.USAGE_PAGE_GN_TELEPHONY,Ie.USAGE_TELEPHONY_CONT_SET,1),W(!0))):n?Je(n,n.primaryAddress,De.GN_TELEPHONY):W(!1)}(t).pipe(kt(t=>(on("Unable to toggle GN HID telephony default. Error: ",t,n,fe.INFO,de.JS_LIB),W())),ot(e=>t)),void 0===r&&(r=Y),void 0===i&&(i=Y),Ot((function(){return e()?r:i}));var e,r,i}))}class un{constructor(t,e){this.foundationLayer=t,this.logger=e;const n=new N;this.deviceAdded=n;const r=new N;this.deviceRemoved=r;var i;t.deviceAttachDetach.pipe(At(t=>t.type===ye.Type.ATTACH?this.handleAttachEvent(t):this.handleDetachEvent(t),i,1)).subscribe(t=>{t instanceof ze?n.next(t):"string"==typeof t&&""!==t&&r.next(t)})}handleAttachEvent(t){return sn(this.foundationLayer,t,this.logger).pipe(kt(e=>(Ae(`Failure in attaching device (ID: ${t.id}): ${e}`,this.logger,fe.WARNING),W())))}handleDetachEvent(t){const e=t.id;return t.type===ye.Type.DETACH?W(e):W("")}}var cn,an,hn,ln,pn,fn,dn;class En{constructor(t,r,i){cn.set(this,void 0),an.set(this,void 0),hn.set(this,void 0),n(this,cn,t),n(this,an,r),n(this,hn,new We(e(this,cn).hidChannel,e(this,cn).callLock,e(this,cn).id,e(this,an),i))}get id(){return e(this,cn).id}get name(){return e(this,cn).name}get vendorId(){return e(this,cn).vendorId}get productId(){return e(this,cn).productId}get browserLabel(){return`${e(this,cn).vendorId.toString(16).padStart(4,"0")}:${e(this,cn).productId.toString(16).padStart(4,"0")}`}get deviceSignals(){return e(this,hn).deviceSignals}takeCallLock(){return e(this,hn).getCallLock().toPromise()}releaseCallLock(){e(this,hn).releaseCallLock()}offHook(t){e(this,hn).offHook(t)}ring(t){e(this,hn).ring(t)}mute(t){e(this,hn).mute(t)}hold(t){e(this,hn).hold(t)}}cn=new WeakMap,an=new WeakMap,hn=new WeakMap;class _n{constructor(t,e,r,i,o){this.transportContext=i,ln.set(this,void 0);const s=new C([]);this.deviceList=s,n(this,ln,r),t.deviceAdded.subscribe(t=>{const n=s.getValue();n.findIndex(e=>e.id===t.id)>-1?Ae("Device duplication error - we detected the same device twice.",o,fe.WARNING):t.supportsCallControl()?(n.push(new En(t,e,o)),s.next(n)):Ae("Device not added due to internal filtering rules.",o,fe.INFO)}),t.deviceRemoved.subscribe(t=>{const e=s.getValue(),n=e.findIndex(e=>e.id===t);-1!==n?(e.splice(n,1),s.next(e)):Ae("Device missing error - device removal not possible.",o,fe.INFO)})}getVersion(){return e(this,ln).sdkVersion}getChromehostVersion(){return e(this,ln).consoleAppVersion.toPromise()}getChromeExtensionVersion(){return e(this,ln).chromeExtensionVersion.toPromise()}}function vn(e,n=fn.CHROME_EXTENSION,r){return t(this,void 0,void 0,(function*(){if(n!==fn.WEB_HID){const t=yield import("./chrome-extension-tranport-81036454.js"),i=yield t.TransportChromeExtension.checkInstallation();if(i.ok)return Ae("Using Chrome extension for transport.",e,fe.INFO),new t.TransportChromeExtension(e,r);if(n===fn.CHROME_EXTENSION)throw new we(i.message,Ee.INIT_ERROR);n===fn.CHROME_EXTENSION_WITH_WEB_HID_FALLBACK&&Ae(i.message,e,fe.INFO)}return Ae("Using WebHID for transport.",e,fe.INFO),function(e,n){return t(this,void 0,void 0,(function*(){const t=yield import("./init-handler-ca753e00.js"),r=yield import("./web-hid-transport-3419349c.js"),i=t.initHandler(e);return new r.WebHidTransport(i,e,n)}))}(e,r)}))}function yn(e,n=null){var r,i,o;return t(this,void 0,void 0,(function*(){if(!e)throw new we('Please provide softphone info when initializing the library. Example: await init({ name: "my-third-party-phone-app", uuid: "3b9d6acb-6435-4e75-abd2-7b77c28fa3b0"})',Ee.SDK_USAGE_ERROR);const t=null==n?void 0:n.logger;Ae("Jabra SDK JS starting up...",t,fe.INFO);const s=null!==(i=null===(r=null==n?void 0:n.internal)||void 0===r?void 0:r.testDeviceTransport)&&void 0!==i?i:yield vn(t,null==n?void 0:n.transport,null===(o=null==n?void 0:n.internal)||void 0===o?void 0:o.recorder),u=new ke(s,t),c=new un(u,t),a=new Fe(u,t),h=new _n(c,u.softphoneInFocus,a,s.context,t);return yield s.connect().toPromise(),u.setSharedSoftphoneInfo(e),h}))}ln=new WeakMap,function(t){t.NODE="node",t.CHROME_EXTENSION="chrome-extension",t.WEB_HID="web-hid"}(pn||(pn={})),function(t){t.CHROME_EXTENSION="chrome-extension",t.WEB_HID="web-hid",t.CHROME_EXTENSION_WITH_WEB_HID_FALLBACK="chrome-extension-with-web-hid-fallback"}(fn||(fn={}));class bn{constructor(t,e,n,r){this.deviceId=t,this.usagePage=e,this.usage=n,this.value=r}}class gn{constructor(t,e){this.token=t,this.value=e}}!function(t){t.UsageReport=class{constructor(t,e){this.usage=t,this.value=e}}}(dn||(dn={}));var An,wn=Se((function(t){!function(e){var n=function(t,e,n){if(!(t instanceof ArrayBuffer||"undefined"!=typeof Buffer&&t instanceof Buffer))throw new Error("Must specify a valid ArrayBuffer or Buffer.");e=e||0,n=n||t.byteLength||t.length,this._view=new Uint8Array(t.buffer||t,e,n),this.bigEndian=!1};n._scratch=new DataView(new ArrayBuffer(8)),Object.defineProperty(n.prototype,"buffer",{get:function(){return"undefined"!=typeof Buffer?Buffer.from(this._view.buffer):this._view.buffer},enumerable:!0,configurable:!1}),Object.defineProperty(n.prototype,"byteLength",{get:function(){return this._view.length},enumerable:!0,configurable:!1}),n.prototype._setBit=function(t,e){e?this._view[t>>3]|=1<<(7&t):this._view[t>>3]&=~(1<<(7&t))},n.prototype.getBits=function(t,e,n){var r=8*this._view.length-t;if(e>r)throw new Error("Cannot get "+e+" bit(s) from offset "+t+", "+r+" available");for(var i=0,o=0;o<e;){var s=e-o,u=7&t,c=this._view[t>>3],a=Math.min(s,8-u);this.bigEndian?(i<<=a,i|=c>>8-a-u&~(255<<a)):i|=(c>>u&~(255<<a))<<o,t+=a,o+=a}return n?(32!==e&&i&1<<e-1&&(i|=-1^(1<<e)-1),i):i>>>0},n.prototype.setBits=function(t,e,n){var r=8*this._view.length-t;if(n>r)throw new Error("Cannot set "+n+" bit(s) from offset "+t+", "+r+" available");for(var i=0;i<n;){var o,s,u,c=n-i,a=7&t,h=t>>3,l=Math.min(c,8-a);if(this.bigEndian){s=e>>n-i-l&(o=~(-1<<l));var p=8-a-l;u=~(o<<p),this._view[h]=this._view[h]&u|s<<p}else s=e&(o=~(255<<l)),e>>=l,u=~(o<<a),this._view[h]=this._view[h]&u|s<<a;t+=l,i+=l}},n.prototype.getBoolean=function(t){return 0!==this.getBits(t,1,!1)},n.prototype.getInt8=function(t){return this.getBits(t,8,!0)},n.prototype.getUint8=function(t){return this.getBits(t,8,!1)},n.prototype.getInt16=function(t){return this.getBits(t,16,!0)},n.prototype.getUint16=function(t){return this.getBits(t,16,!1)},n.prototype.getInt32=function(t){return this.getBits(t,32,!0)},n.prototype.getUint32=function(t){return this.getBits(t,32,!1)},n.prototype.getFloat32=function(t){return n._scratch.setUint32(0,this.getUint32(t)),n._scratch.getFloat32(0)},n.prototype.getFloat64=function(t){return n._scratch.setUint32(0,this.getUint32(t)),n._scratch.setUint32(4,this.getUint32(t+32)),n._scratch.getFloat64(0)},n.prototype.setBoolean=function(t,e){this.setBits(t,e?1:0,1)},n.prototype.setInt8=n.prototype.setUint8=function(t,e){this.setBits(t,e,8)},n.prototype.setInt16=n.prototype.setUint16=function(t,e){this.setBits(t,e,16)},n.prototype.setInt32=n.prototype.setUint32=function(t,e){this.setBits(t,e,32)},n.prototype.setFloat32=function(t,e){n._scratch.setFloat32(0,e),this.setBits(t,n._scratch.getUint32(0),32)},n.prototype.setFloat64=function(t,e){n._scratch.setFloat64(0,e),this.setBits(t,n._scratch.getUint32(0),32),this.setBits(t+32,n._scratch.getUint32(4),32)},n.prototype.getArrayBuffer=function(t,e){for(var n=new Uint8Array(e),r=0;r<e;r++)n[r]=this.getUint8(t+8*r);return n};var r=function(t,e){return function(){if(this._index+e>this._length)throw new Error("Trying to read past the end of the stream");var n=this._view[t](this._index);return this._index+=e,n}},i=function(t,e){return function(n){this._view[t](this._index,n),this._index+=e}};function o(t,e,n){if(0===e)return"";var r=0,i=[],o=!0,s=!!e;for(e||(e=Math.floor((t._length-t._index)/8));r<e;){var u=t.readUint8();if(0===u&&(o=!1,!s))break;o&&i.push(u),r++}var c=String.fromCharCode.apply(null,i);if(!n)return c;try{return decodeURIComponent(escape(c))}catch(t){return c}}var s=function(t,e,r){var i=t instanceof ArrayBuffer||"undefined"!=typeof Buffer&&t instanceof Buffer;if(!(t instanceof n||i))throw new Error("Must specify a valid BitView, ArrayBuffer or Buffer");this._view=i?new n(t,e,r):t,this._index=0,this._startIndex=0,this._length=8*this._view.byteLength};Object.defineProperty(s.prototype,"index",{get:function(){return this._index-this._startIndex},set:function(t){this._index=t+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"length",{get:function(){return this._length-this._startIndex},set:function(t){this._length=t+this._startIndex},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"bitsLeft",{get:function(){return this._length-this._index},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"byteIndex",{get:function(){return Math.ceil(this._index/8)},set:function(t){this._index=8*t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"buffer",{get:function(){return this._view.buffer},enumerable:!0,configurable:!1}),Object.defineProperty(s.prototype,"view",{get:function(){return this._view},enumerable:!0,configurable:!1}),Object.defineProperty(s.prototype,"bigEndian",{get:function(){return this._view.bigEndian},set:function(t){this._view.bigEndian=t},enumerable:!0,configurable:!1}),s.prototype.readBits=function(t,e){var n=this._view.getBits(this._index,t,e);return this._index+=t,n},s.prototype.writeBits=function(t,e){this._view.setBits(this._index,t,e),this._index+=e},s.prototype.readBoolean=r("getBoolean",1),s.prototype.readInt8=r("getInt8",8),s.prototype.readUint8=r("getUint8",8),s.prototype.readInt16=r("getInt16",16),s.prototype.readUint16=r("getUint16",16),s.prototype.readInt32=r("getInt32",32),s.prototype.readUint32=r("getUint32",32),s.prototype.readFloat32=r("getFloat32",32),s.prototype.readFloat64=r("getFloat64",64),s.prototype.writeBoolean=i("setBoolean",1),s.prototype.writeInt8=i("setInt8",8),s.prototype.writeUint8=i("setUint8",8),s.prototype.writeInt16=i("setInt16",16),s.prototype.writeUint16=i("setUint16",16),s.prototype.writeInt32=i("setInt32",32),s.prototype.writeUint32=i("setUint32",32),s.prototype.writeFloat32=i("setFloat32",32),s.prototype.writeFloat64=i("setFloat64",64),s.prototype.readASCIIString=function(t){return function(t,e){return o(t,e,!1)}(this,t)},s.prototype.readUTF8String=function(t){return function(t,e){return o(t,e,!0)}(this,t)},s.prototype.writeASCIIString=function(t,e){!function(t,e,n){for(var r=n||e.length+1,i=0;i<r;i++)t.writeUint8(i<e.length?e.charCodeAt(i):0)}(this,t,e)},s.prototype.writeUTF8String=function(t,e){!function(t,e,n){for(var r=function(t){var e,n,r=[];for(e=0;e<t.length;e++)(n=t.charCodeAt(e))<=127?r.push(n):n<=2047?(r.push(n>>6|192),r.push(63&n|128)):n<=65535?(r.push(n>>12|224),r.push(n>>6&63|128),r.push(63&n|128)):(r.push(n>>18|240),r.push(n>>12&63|128),r.push(n>>6&63|128),r.push(63&n|128));return r}(e),i=n||r.length+1,o=0;o<i;o++)t.writeUint8(o<r.length?r[o]:0)}(this,t,e)},s.prototype.readBitStream=function(t){var e=new s(this._view);return e._startIndex=this._index,e._index=this._index,e.length=t,this._index+=t,e},s.prototype.writeBitStream=function(t,e){var n;for(e||(e=t.bitsLeft);e>0;)n=Math.min(e,32),this.writeBits(t.readBits(n),n),e-=n},s.prototype.readArrayBuffer=function(t){var e=this._view.getArrayBuffer(this._index,t);return this._index+=8*t,e},s.prototype.writeArrayBuffer=function(t,e){this.writeBitStream(new s(t),8*e)},t.exports&&(t.exports={BitView:n,BitStream:s})}()}));function Tn(){return t(this,void 0,void 0,(function*(){const{hid:t}=window.navigator;if(!t)throw new we("WebHID not supported",Ee.INIT_ERROR);yield t.requestDevice({filters:[{vendorId:An.VENDOR_ID}]});new BroadcastChannel(An.PAIRING_CHANNEL).postMessage(null)}))}!function(t){t[t.VENDOR_ID=2830]="VENDOR_ID",t.PAIRING_CHANNEL="jabra-webhid-pairing-channel"}(An||(An={}));export{Ee as E,dn as I,we as J,fe as L,$ as N,A as O,fn as R,_ as S,pn as T,ve as V,bn as W,i as _,tt as a,N as b,t as c,gn as d,At as e,Pt as f,wn as g,Ut as h,jt as i,de as j,An as k,Ae as l,ot as m,yn as n,Ce as o,ee as s,q as t,Re as u,Tn as w};
